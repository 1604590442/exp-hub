# 0x00 软件介绍
struts2：面向java ee的一款java web开发框架

# 0x01 复现环境
使用环境：vulhub中的环境：https://github.com/vulhub/vulhub/tree/master/struts2/s2-061  
复现版本：Apache Struts 2.5.25

# 0x02 环境搭建
找一台云上的vps  
git clone https://github.com/vulhub/vulhub  
cd ./vulhub/  
cd ./struts2/  
cd ./s2-061/  
systemctl start docker  
docker-compose up -d

# 0x03 利用条件
此次漏洞只是S2-059修复的一个绕过，并且本次利用的核心类org.apache.commons.collections.BeanMap在commons-collections-x.x.jar包中，但是在官方的最小依赖包中并没有包含这个包。所以即使扫到了支持OGNL表达式的注入点，但是如果没有使用这个依赖包，也还是没办法进行利用

# 0x04 影响版本
Apache Struts 2.0.0 - Struts 2.5.25

# 0x05 漏洞复现
攻击环境：kali_x64_en-us

git clone https://github.com/lijiejie/GitHack  
cd ./GitHack-master  
python ./GitHack.py http://124.126.19.106:31232/.git/  
如下图  
![image](./0.png)  
![image](./1.png)  

# 0x06 踩坑记录
坑0：Exploit aborted due to failure: bad-config: Set the most appropriate target manually  
表示需要设置对应的目标

# 0x07 参考链接
https://github.com/rapid7/metasploit-framework/pull/12283
